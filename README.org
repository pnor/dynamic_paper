#+title: Dynamic Paper

Display, and manage wallpapers on Linux

* Background Sets
Different wallpaper backgrounds are organized into a concept of "Background Sets". You can choose to
show 1 background set, which will change the background. A background set can be =static=, which will
show a single image, or =dynamic=, which will change at different times of the day.

You can list all the different types of background sets in a yaml config file (by default, =~/.local/share/dynamic_paper/background_sets.yaml=).

* The General Config
This is where configs go that affect how the entire program works.
#+begin_src yaml
background_config: ~/.local/share/dynamic_paper/dynamic_paper.yaml
hook_script: ~/script_on_background.sh
cache_dir: ~/.cache/dynamic_paper
logging_level: off
log_file: ~/.local/share/dynamic_paper/dynamic_paper.log
latitude: 40.730610
longitude: -73.935242
sunrise: 08:00
sunset: 20:00
use_config_file_location: true
#+end_src

*background_config*: path to file that stores background sets.
- default is =~/.local/share/dynamic_paper/dynamic_paper.yaml=

*hook_script (optional)*: path to a script that is run after setting the background. The full path name of the
background image is passed as the first arguement of the script.
- default is None, and will not run any script

*cache_dir*: Directory to store cached images created when transitioning between 2 images.
- default is =~/.cache/dynamic_paper=

*logging_level*: Level and amount of logs generated by the program.
- default is "info"

*log_file*: File to write logs to.
- default is =~/.local/share/dynamic_paper/dynamic_paper.log=

*latitude*: When unable to determine the user's location, will use this latitude value to determine
  the time of the sunrise and sunset. You must provide this default value to have =dynamic_paper= infer your location.
- default is =40.730610=

*longitude*: When unable to determine the user's location, will use the longitude value to determine
the time of the sunrise and sunset. You must provide this default value to have =dynamic_paper= infer your location.
- default is =-73.935242=

*sunrise*: Time to use for sunrise. If set, will NOT check the user's location, and will use this
value instead.
- default is None

*sunset*: Time to use for sunset. If set, will NOT check the user's location, and will use this value instead.
- default is None

*use_config_file_location*: If true, will NOT check the user's location, and instead use the =latitude=
 and =longitude= value's provided in this config file.
- default is =false=

* Background Set Config
**  Static Background Set Config
A static background sets one image as the background.

#+begin_src yaml
# Set the background to ~/pictures/landscape.jpg
my_wallpaper:
  type: static
  image_directory: "~/pictures"
  mode: fill
  image: landscape.jpg

# Set the background randomly to either ~/pictures/1.jpg or ~/pictures/2.jpg
some-wallpapers:
  type: static
  image_directory: "~/pictures"
  mode: center
  images:
    - 1.jpg
    - 2.jpg
#+end_src

*type*: Must be "static" to show a single image, and not change it over time.
- Required

*image_directory*: the directory from where images are searched for in.
- Required

*image* or *images*: Either a single name or list of names. Together with =image_directory=, this forms
the full path of the image to set as the wallpaper, formed like =image_directory / image=.
- EIther =image= or =images= is required

*mode*: Display mode. Can be either "center", "fill", "tile", or "scale".
- Defaults to "center"

** Dynamic Background Config
A dynamic background set shows multiple images over the course of the day, at specific times of the day.

#+begin_src yaml
# Set the background to change over the course of the day
dynamic_wallpaper:
  type: dynamic
  image_directory: "~/pictures"
  transition_length: 60
  number_transition_steps: 5
  mode: scale
  order: linear
  images:
    - dawn.jpg
    - day.jpg
    - dusk.jpg
    - night.jpg
  times:
    - -3:00 sunrise
    - +1:00 sunrise
    - -1:00 sunset
    - +0:00 sunset

# Change the background to a random choice of ~/pictures/one.jpg,
# ~/pictures/two.jpg, or ~/pictures/three.jpg, and change at 10:00 and 20:00
dynamic_wallpaper2:
  type: dynamic
  image_directory: "~/pictures"
  mode: tile
  order: random
  images:
    - one.jpg
    - two.jpg
    - three.jpg
  times:
    - 10:00
    - 20:00
#+end_src

*type*: Must be "dynamic" to show multiple images.

*image_directory*: the directory from where images are searched for in.

*image* or *images*: Either a single name or list of names. Together with =image_directory=, this forms
the full path of the image to set as the wallpaper. The path to the image that will be shown can be
found by combining the =data_directory= ad =images= paths: =data_directory= =/= =image=

*mode*: Display mode. Can be either "center", "fill", "tile", or "scale".
- Defaults to "center"

*order*: Can be "linear" or "random". If "linear", will show the images from top to bottom in order.
If "random", chooses one of the images randomly.
- Defaults to "linear"

*images*: List of images to show. If =order= is "linear", then the number of images *must match* the
number of =times=.
- Required

*times*: When to change the image. Can be a time string formatted "HH:MM" or an offset from the
sunrise or sunset, like "-01:00 sunset".
- Required

*transition_length*: How long, in seconds, to transition between one image to the next.
- Optional; if not provided, will not transition.

*number_transition_steps*: Number of images to create when interpolating between one image to the next.
- Default is 5

  *in_place*: Whether to transition using a single temp file instead of creating files in the cache directory.
 - Default is false

* Usage:
#+begin_src bash
# Show a background set
dynamic_paper show <name>

# List available background sets
dynamic_paper list

# Show a random background set
dynamic_paper random

# Show where cache'd images are stored
dynamic_paper cache info
#+end_src

By default, =dynamic_paper= reads a file called =~/.config/dynamic_paper/dynamic_paper.yaml= for
settings. This will read  =~/.local/share/dynamic_paper/background_sets.yaml= for information about
all background sets.

* How to Build + Run
Use the helper script:
#+begin_src bash
# Run in debug mode
./build.sh run
# Run in release mode
./build.sh run-release
# Run the tests
./build.sh test
# Pass args, like a test config or options
./build.sh run list
./build.sh run random
./build.sh run --config "config.yaml" --stdout show my_wallpaper
#+end_src

Or use cmake directly
#+begin_src bash
# from the project root..

mkdir -p Release
cd Release
cmake -DCMAKE_BUILD_TYPE=Debug .. # or do "Release" for release mode
# run
make dynamic_paper
./bin/dynamic_paper
# run tests
make dynamic_paper_test
./bin/dynamic_paper_test
#+end_src
